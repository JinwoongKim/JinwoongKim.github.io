---
title: Kubernetes secret 만들기
categories: kubernetes
tags:
  - kubernetes
  - k8s
  - secret
published: false
---


업무상 쿠버네티스를 많이 쓰는데 `secret` 을 직접 만들어 써본적은 없었다.

이번에 만들일이 생겨서 credential을 저장 할 수 있는 secret 을 어떻게 만들고, 사용하는지 정리해본다.


사용자가 kubectl 혹은 시크릿을 만들 환경이 구성되어있다고 가정하였다.
{: .notice--warning}

### K8s Secret 이란?
K8s의 문서를 보면 아래와 같이 서술되어 있다.

>시크릿은 암호, 토큰 또는 키와 같은 소량의 중요한 데이터를 포함하는 오브젝트이다. 이를 사용하지 않으면 중요한 정보가 [파드](https://kubernetes.io/ko/docs/concepts/workloads/pods/) 명세나 [컨테이너 이미지](https://kubernetes.io/ko/docs/reference/glossary/?all=true#term-image)에 포함될 수 있다. 시크릿을 사용한다는 것은 사용자의 기밀 데이터를 애플리케이션 코드에 넣을 필요가 없음을 뜻한다.

출처 : https://kubernetes.io/ko/docs/concepts/configuration/secret/

그런데 시크릿이 완벽한 솔루션은 아니다. 결국 같은 네임스페이스를 쓰거나 팟에 들어올 수 있는 사람들은 어떻게든 시크릿을 볼 수 있기 때문이다.

하지만 익숙해지면 만드는게 어렵지도 않고, 코드나 이미지에 없다는 것만으로도 노출도가 내려간다고 생각해서, 사용하지 않는 것보단 훨씬 낫다고 생각한다.
### 어떻게 만드는가?



시크릿에 모든 value 는 base64로 인코딩 되어야 한다. 나는 bash가 매우 익숙한 사람인데, 리눅스/맥 터미널에 아래 코드를 이용하면 쉽게 인코딩 할 수 있다. (윈도우는 파워쉘로 하면 되지 않을까 싶다.)

```bash
echo -n '인코딩할문자열' | base64
```

수행 예

```bash
jinwoong.kim $ echo -n '인코딩할문자열' | base64
7J247L2U65Sp7ZWg66y47J6Q7Je0
jinwoong.kim $
```

### 어떻게 사용하는가?

